# COIAS の使用方法

<!-- ## 基本的な使い方 -->

全自動処理で行う方法と、各工程ずつ手動で行う 2 つの方法がある

1. 探索準備でファイルを選択する
1. 全自動処理または手動処理（手動処理の場合下記の順番で行う）
   1. 事前処理
   1. ビニングマスク
   1. 軌道取得（確定番号）
   1. 軌道取得（仮符号）
   1. 自動検出
1. 探索/再描画で天体を選択し、再描画する
1. 手動測定で自動検出から漏れた天体を選択し、再描画する
1. レポート画面にてレポートが出力される
   <br>
   <br>

# 各画面の説明

## 探索準備

探索用のファイルアップロード、および探索準備のための事前処理を行うことができる。
<br>
<br>
**全自動処理**
<img width="1280" alt="prepare01" src="https://user-images.githubusercontent.com/105190797/185337175-7d084fb4-2fc9-4288-bd25-bc118ba1610b.png">

- **ファイル** : ファイルの選択（.fits）
- **全自動処理** : 事前処理から自動検出まで自動で処理を行う（ビニングマスクは 2×2）

<br>

<img width="1280" alt="prepare_file_modal" src="https://user-images.githubusercontent.com/105190797/185337506-3e49d3d8-ca4c-42c3-8e27-b16a2dd0701c.png">
「ファイル」をクリックすると「ファイルアップロード」モーダルが表示される。
このモーダルでは探索用ファイルをアップロードでき、全自動処理・手動処理の選択ができる。
また、「小惑星データ更新」で最新の MPC データを取り込む事ができる。

<br>

**手動処理**
<img width="1280" alt="prepare02_manual" src="https://user-images.githubusercontent.com/105190797/185336914-1b7f8714-a2e3-456c-83e4-42d09da54060.png">

- **事前処理** : 事前処理
- **ビニングマスク** : ビニングマスクの選択（2×2 又は 4×4）
- **軌道取得（確定番号）** : 軌道取得（確定番号）
- **軌道取得（仮符号）** : 軌道取得（仮符号）
- **自動検出** : 自動検出
  <br>

<br>

## 探索/再描画

事前処理を行ったファイルに対して、探索/再描画を行う画面。

この画面では「上下カーソルキー」で画像の拡大・縮小ができる。
<img width="1280" alt="explore" src="https://user-images.githubusercontent.com/105190797/185339149-1ab44aeb-fae0-4357-b370-d2ae4b46e846.png">

1. ブリンク再生・コマ送りを行う。また、再生時の画像の切り替え速度を変更できる。また、キーボードの「s キー」で再生、「左右カーソルキー」でコマ送りを行う。
2. 表示する画像を手動で選択できる。
3. 「表示設定（歯車アイコン）」モーダル（後述）、およびヘルプを表示する。
4. 「選択モード（矢印アイコン）」で天体の選択、「リセットボタン」で天体選択及びズームのリセットができる。また、「非表示ボタン」で天体名、天体の枠の表示・非表示切り替えができる。
5. 輝度、コントラストを変更できる。
6. 天体の枠内をクリックすることにより、天体を選択できる。
7. 画像に表示されている天体の一覧。選択された天体にチェックマークが付く。この一覧からチェックマークを入れることもできる。
8. 探索終了し、再描画を行う。

   <br>

**表示設定**
<img width="1280" alt="explore_setting_modal" src="https://user-images.githubusercontent.com/105190797/185339860-01d8bbaf-5f51-4d08-be04-0ac433883e3e.png">
表示する画像、およびマスクの有無、オートセーブ機能の ON・OFF が選択ができる。
<br>

**新天体の番号指定モーダル**
<img width="1280" alt="re-draw-modal" src="https://user-images.githubusercontent.com/105190797/185341337-0646a232-6b1c-4d3b-a36c-0c276d80f178.png">
選択した天体の先頭の番号を指定することができる。変更を加えない場合、次へを押す。
<br>

**再描画**
<img width="1280" alt="re-draw" src="https://user-images.githubusercontent.com/105190797/185342627-b4ccf67b-094b-4fdc-b10e-63eb0d038997.png">
選択した天体のみを表示した画像を再描画する。
選択を変更したい場合、「やり直す」ボタンで探索画面に戻ることができる。
再描画に問題がない場合、手動測定画面又はレポート画面に進む。

<br>
<br>

## 手動測定

<img width="1280" alt="manual" src="https://user-images.githubusercontent.com/105190797/185344411-7fe93dbc-51f4-45f1-9c42-bdb9b499a127.png">
自動検出できなかった天体を手動で選択するモード。
画像上で、天体と思われる箇所をクリックし、新たに天体を作成できる。

1. 天体を追加。
2. 手動で選択した天体情報。各画像でクリックした天体の座標値が表示される。
3. 「削除する」で選択している天体の削除、「再描画」で探索画面と同じように再描画をすることができる。また、再描画後に天体名の付け替え機能が使えるようになる（後述）。（2 で作成した天体にチェックマークを入れることにより、「削除する」ボタンを表示させることができる。）
   <br>

<br>

**天体選択モーダル**
<img width="1280" alt="manual-modal" src="https://user-images.githubusercontent.com/105190797/185347520-c8a87ef8-2214-4870-937d-8c8d6f829db1.png">
天体を囲むように、3 点をクリックすると自動で四角が生成される。
<br>

**天体名の付け替え機能**
<img width="1280" alt="manual_append_modal" src="https://user-images.githubusercontent.com/105190797/185347969-20c355d9-4d01-415a-8fc1-8654e9efc901.png">
手動測定の再描画後に天体名の付け替えが行える。
名前の付け替えを行いたい天体をクリックし、変更後の名前を選ぶ。
既知天体の名前は付け替えることができない。
付け替えた後の天体を再度クリックすると、付け替えを戻す事ができる。

<br>

<br>
<br>

## レポート

<img width="1280" alt="report" src="https://user-images.githubusercontent.com/105190797/185348336-da0a278b-1e16-4f64-aaf0-25ed0acb299c.png">

OBS（観測者）と MEA（測定者）の入力、およびレポート内容のテキストファイルダウンロードが行える。
